# üó®Ô∏è –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–ß–∞—Ç"

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —á–∞—Ç–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –∏—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤.

---

## ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –ß–∞—Ç (WebSocket)

- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ WebSocket.
- –û–±–º–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤.
- –°–æ–æ–±—â–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ PostgreSQL.

–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
- ID —Å–æ–æ–±—â–µ–Ω–∏—è
- ID —á–∞—Ç–∞
- ID –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
- –¢–µ–∫—Å—Ç
- –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ü—Ä–∏–∑–Ω–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è


---

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏–µ. –í docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.

- –ó–∞–ø—É—Å—Ç–∏—Ç—å alembic run pytest

---

## üì° –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### üîê –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**POST** `/register`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "name": "string",
  "email": "user@example.com",
  "password": "string"
}
```

---

### üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**POST** `/login`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "email": "user@example.com",
  "password": "string"
}
```

**–û—Ç–≤–µ—Ç:** JWT —Ç–æ–∫–µ–Ω  
**–í–∞–∂–Ω–æ:** –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥—Ä—É–≥–∏–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫:
```
Authorization: Bearer <—Ç–æ–∫–µ–Ω>
```

---

### üìÉ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**GET** `/users_list`

**–û—Ç–≤–µ—Ç:**
```json
{
  "users": [
    {
      "user_uuid": "string",
      "name": "string"
    }
  ]
}
```
### üìÉ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞

**GET** `/history/{chat_id:int}&page=int&page_size=int`

**–û—Ç–≤–µ—Ç:**
```json
{
    "messages": [
        {
            "id": "int",
            "chat_id": "int",
            "sender_uuid": "str",
            "text": "str",
            "timestamp": "2025-04-28T19:29:53.059421",
            "read_status": "unread/read"
        }
    ]
}
```

---

## üîå WebSocket

**URL:** `ws://localhost:8000/connect`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <—Ç–æ–∫–µ–Ω>`

---

## üßæ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ WebSocket-–∫–æ–º–∞–Ω–¥—ã

### 1. `create_chat`

–°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞ (–ª–∏—á–Ω–æ–≥–æ –∏–ª–∏ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ)

```json
{
  "action": "create_chat",
  "type": "group"/"private",
  "name": "string",
  "user_ids": ["uuid"]
}
```

---

### 2. `send_message`

–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç

```json
{
  "action": "send_message",
  "chat_id": "chat_id",
  "text": "string"
}
```

---

### 3. `mark_read`

–ü–æ–º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ.  
–ö–æ–≥–¥–∞ –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —á–∞—Ç–∞ –ø—Ä–æ—á–∏—Ç–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –æ–Ω –æ–Ω–ª–∞–π–Ω).

```json
{
  "action": "mark_read",
  "message_ids": [123, 456]
}
```

---

### üì• –°–ø–∏—Å–æ–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ WebSocket –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:

```json
{
  "action": "unread_messages",
  "data": [
    {
      "id": 123,
      "chat_id": 456,
      "sender_uuid": "string",
      "text": "string",
      "timestamp": "2024-01-01T00:00:00",
      "read_status": "unread"
    }
  ]
}
```
